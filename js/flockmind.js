function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var triggerError=attachErrorHandler("flockpanel",!0);$(document).ready((function(){var t={vitals:{},partitions:[],drones:[],enemies:[]},e=["#802020","#FF0000","#FFA200","#FFFB00","#C8FF00","#00FF00"],n=null,a={partitions:[{name:"name",content:"??.?"},{name:"host",content:""},{name:"health",content:100},{name:"jump",action:"jump_to",content:'<i class="icon-map-marker"></i>'},{name:"eject",action:"eject_trace",content:'<i class="icon-eject"></i>',required:"host"},{name:"delete",action:"delete_trace",content:'<i class="icon-ban-circle"></i>'}],drones:[{name:"name",content:"??.??.??"},{name:"health",content:100},{name:"resources",content:0},{name:"task",content:0},{name:"area",content:"Unknown"},{name:"jump",action:"jump_to",content:'<i class="icon-map-marker"></i>'},{name:"rally",action:"rally",content:'<i class="icon-reply-all"></i>'}],enemies:[{name:"name",content:"Unknown"},{name:"area",content:"Unknown"},{name:"remove",action:"remove_enemy",content:'<i class="icon-remove"></i>'}]};function o(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function r(t){return t.slice(3,-1)}function i(t){t=Math.floor(t);var n=function(t,e,n,a){if(Array.isArray(t)&&!isNaN(e)&&!isNaN(n)&&!isNaN(a)){if(n>a){var r=n;n=a,a=r}e=function(t,e,n){return t<=e?e:t>=n?n:t}(e,n,a);var i=(e-n)/(a-n);if(i>=1)return t[t.length-1];var c=i*t.length,s=Math.floor(c),l=c-s,f=o(t[s]),u=o(t[s+1]),d={r:f.r+(u.r-f.r)*l,g:f.g+(u.g-f.g)*l,b:f.b+(u.b-f.b)*l};return"#"+((1<<24)+(Math.floor(d.r)<<16)+(Math.floor(d.g)<<8)+Math.floor(d.b)).toString(16).slice(1)}}(e,t,0,100);return"<span style='color:"+n+"'>"+t+"%</span>"}function c(e){var o=t[e],i=$("#"+e),c=a[e];$.each(o,(function(t,a){if(a.ref){var o,s,l,f=r(a.ref),u=$("#"+e+"-"+f);0===u.length&&(u=$("<tr>").attr("id",e+"-"+f)).appendTo(i),$.each(c,(function(t,r){if(0===(o=u.find("."+r.name)).length&&(o=$("<td>").addClass(r.name),u.append(o)),r.action){if(0===(s=o.find("#"+e+"-"+r.name+"-"+f)).length){s=$("<a>").addClass("button").attr("id",e+"-"+r.name+"-"+f),o.append(s);var i="[0x"+f+"]";s.click((function(){!function(t,e){window.location="?src="+n+"&action="+e+"&origin="+t}(i,r.action)})),s.html(r.content)}if(r.required)null!==a[r.required]?s.attr("disabled",!1):s.attr("disabled",!0)}else l=a[r.name]?a[r.name]:r.content,o.html(l)}))}}))}function s(){var e,n;"vitals"===t.tab?(e=$("#vitals"),n=t.vitals,e.find("td.value").each((function(t,e){var a=e.id.split("-")[1];e.innerHTML="undefined"!=typeof n[a]?n[a]:"???"}))):t[t.tab]&&t[t.tab].length>0&&c(t.tab),$(".health").each((function(){var t=$(this).text();$(this).html(i(parseInt(t)))}))}function l(e){$(".tabcontent").hide(),$(".tablinks").removeClass("selected"),$("#tab-button-"+e).addClass("selected"),$("#tab-"+e).show(),t.tab=e,s()}function f(){var e,n,a=$(this),o=a.attr("id").split("-"),r=o[0],i=t[r],c=o[1],l=t.sort[r],f=-1;l?("undefined"!=typeof l[c]&&(f=-1*l[c]),l[c]=f):t.sort[r]={sortOn:f},e=i,n=c,f<0?e.sort((function(t,e){return t[n]<e[n]?-1:e[n]<t[n]?1:0})):e.sort((function(t,e){return t[n]>e[n]?-1:e[n]>t[n]?1:0}));var u=$("#"+r);u.find("tr:gt(0)").remove(),u.find(".sortable").removeClass("selected asc desc"),a.addClass("selected "+(1===f?"desc":"asc")),s()}function u(){window.location="?src="+n+"&action=update"}function d(e,n){t[e]=[],$.each(n,(function(n,a){"object"===_typeof(a)&&t[e].push(a)}))}function m(e){var n,a,o;if((e=JSON.parse(e))&&e.update)if("flock"===e.update){for(var i in t.vitals={},e.vitals)e.vitals.hasOwnProperty(i)&&(t.vitals[i]=e.vitals[i]);d("drones",e.drones),d("enemies",e.enemies),d("partitions",e.partitions)}else if("add"===e.update){o=t[e.key];var c=!1;for(n=0;n<o.length;++n)if((a=o[n]).ref===e.ref){c=!0,o[n]=e;break}c||o.push(e)}else if("remove"===e.update)for(o=t[e.key],n=0;n<o.length;++n)if((a=o[n]).ref===e.ref){o.splice(n,1);var l=r(a.ref),f=$("#"+e.key+"-"+l);0!==f.length&&f.remove();break}s()}t.sort={},$(".tablinks").click((function(){var t=$(this).attr("id").split("-");l(t[t.length-1])})),s(),l("vitals"),$(".sortable").click(f),n=$("#panel-ref").text(),window.flock={receiveData:m},u(),setInterval(u,3500)}));